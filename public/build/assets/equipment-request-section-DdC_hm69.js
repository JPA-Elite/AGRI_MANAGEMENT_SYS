import{r as a,u as N,s as d,j as e,a as b}from"./app-C6MkzOjK.js";import{g as m,A as S}from"./add-equipment-request-modal-D0P5PUii.js";import v from"./view-equipment-request-modal-C1fuAsTV.js";import{h as E}from"./moment-C5S46NFB.js";import{S as R}from"./spinner-CVGCUM6x.js";import{b as O}from"./general-DOL9TG6R.js";import{S as c}from"./sweetalert2.esm.all-89IKscqO.js";import"./beneficiary-thunk-skZqWhzy.js";import"./XMarkIcon-Bx2PgvMt.js";import"./transition-eMFxa-xb.js";import"./use-server-handoff-complete-DO8r1u7H.js";import"./dialog-DqQg5jl7.js";import"./use-tab-direction-DcbnlBiN.js";function F(){var o;const[x,n]=a.useState(!1),[p,i]=a.useState(null),[u,h]=a.useState(null),[f,r]=a.useState(!1),{equipment_requests:l,loading:g}=N(t=>t.equipment_request);a.useEffect(()=>{d.dispatch(m())},[]);const y=async(t,s)=>{i(null);try{await b.put(`/api/equipment-requests/${t.id}/status`,{status:s}),await d.dispatch(m()),await c.fire({title:"Success!",text:`Status updated successfully to ${s}`,icon:"success",showConfirmButton:!1,timer:1500})}catch(w){console.error("Error updating status:",w),await c.fire({title:"Error!",text:"Failed to update status",icon:"error",showConfirmButton:!0})}},j=t=>{h(t),r(!0)};return g?e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx(R,{size:"h-8 w-8",color:"text-green-500"}),e.jsx("span",{className:"ml-2",children:"Loading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{isOpen:x,setIsOpen:n}),e.jsx(v,{isOpen:f,setIsOpen:r,data:u}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:flex sm:items-center",children:[e.jsxs("div",{className:"sm:flex-auto",children:[e.jsx("h1",{className:"text-base font-semibold text-gray-900",children:"Equipment Requests"}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"A list of all equipment requests from beneficiaries"})]}),e.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:e.jsx("button",{onClick:()=>n(!0),className:"block rounded-md bg-green-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-green-500",children:"Add Request"})})]}),e.jsx("div",{className:"mt-8 flow-root",children:e.jsx("div",{className:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"inline-block min-w-full py-2 align-middle",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Beneficiary"}),e.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Equipment Type"}),e.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Purpose"}),e.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Requested Date"}),e.jsx("th",{className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Status"}),e.jsx("th",{className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(o=l==null?void 0:l.data)==null?void 0:o.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900",children:[t.beneficiary.firstname," ",t.beneficiary.lastname]}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900",children:t.equipment_type}),e.jsx("td",{className:"px-3 py-4 text-sm text-gray-900",children:t.purpose}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900",children:E(t.requested_date).format("LL")}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900",children:p===t.id?e.jsx("select",{className:"rounded-md border-gray-300 text-xs focus:border-green-500 focus:ring-green-500",defaultValue:t.status,onChange:s=>y(t,s.target.value),onBlur:()=>i(null),children:O.map(s=>e.jsx("option",{value:s,children:s},s))}):e.jsx("span",{onClick:()=>i(t.id),className:`inline-flex cursor-pointer rounded-full px-2 text-xs font-semibold leading-5 ${t.status==="approved"?"bg-green-100 text-green-800":t.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-center text-sm font-medium",children:e.jsx("button",{onClick:()=>j(t),className:"text-indigo-600 hover:text-indigo-900",children:"View Details"})})]},t.id))})]})})})})]})]})}export{F as default};
